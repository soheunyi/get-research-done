# Codebase Structure

**Analysis Date:** 2026-02-10

## Directory Layout

```
get-research-done/
├── agy/                        # Antigravity skills and workflows (slash-command support)
│   ├── skills/                 # 12 Antigravity skills for research tasks
│   │   ├── research-ablation-planner/
│   │   ├── research-change-attribution-inspector/
│   │   ├── research-deep-thinker/
│   │   ├── research-evaluation-analyst/
│   │   ├── research-experiment-planner/
│   │   ├── research-hypothesis-designer/
│   │   ├── research-idea-seeker/
│   │   ├── research-notes-tracker/
│   │   ├── research-randomness-auditor/
│   │   ├── research-reproducibility-packager/
│   │   └── research-wandb-integrator/
│   └── workflows/              # Research pipeline stage guidance for Antigravity
│       └── research-pipeline.md # 9-stage pipeline (no 0.5, 1.5, 2.5, 3.5, 4.5)
├── codex/                      # Codex skills and workflows (referenced guidance docs)
│   ├── skills/                 # 12 GRD Codex skills + shared boilerplate
│   │   ├── _shared/            # Canonical boilerplate blocks
│   │   │   └── COMMON_BLOCKS.md
│   │   ├── grd-algo-implementer/
│   │   ├── grd-build-architect/
│   │   ├── grd-codebase-mapper/
│   │   ├── grd-phase-researcher/
│   │   ├── grd-research-attribution-and-robustness/
│   │   ├── grd-research-evaluation-analyst/
│   │   ├── grd-research-experiment-planner/
│   │   ├── grd-research-hypothesis-designer/
│   │   ├── grd-research-ideation-and-reasoning/
│   │   ├── grd-research-notes-tracker/
│   │   ├── grd-research-ops-and-reproducibility/
│   │   └── grd-research-stability-auditor/
│   └── workflows/              # Research pipeline stage guidance for Codex
│       └── research-pipeline.md # 11-stage pipeline (includes 0.5, 1.5, 2.5, 3.5, 4.5)
├── scripts/                    # Installation and maintenance utilities
│   ├── install.sh             # Bash installer for target repositories
│   ├── install.ps1            # PowerShell installer for Windows
│   └── sync_skill_boilerplate.py # Sync COMMON_BLOCKS.md across Codex skills
├── templates/                  # Research output templates
│   ├── research-notes.md       # Template for continuous research notes
│   └── wandb-config.md         # Template for W&B tracking configuration
├── .planning/                  # Strategic planning documents
│   └── codebase/              # Codebase analysis output directory
│       ├── ARCHITECTURE.md     # (this document)
│       ├── STRUCTURE.md        # (this document)
│       ├── STACK.md            # (generated by /gsd:map-codebase tech)
│       ├── INTEGRATIONS.md     # (generated by /gsd:map-codebase tech)
│       ├── CONVENTIONS.md      # (generated by /gsd:map-codebase quality)
│       ├── TESTING.md          # (generated by /gsd:map-codebase quality)
│       └── CONCERNS.md         # (generated by /gsd:map-codebase concerns)
├── .planning/                  # User working directory for planning outputs
│   └── research/              # Phase-level research outputs
│       └── phases/{phase_id}-RESEARCH.md
├── .planning/                  # User working directory for codebase outputs
│   └── codebase/              # Codebase mapping outputs
│       ├── CURRENT.md         # Current repository state snapshot
│       ├── TARGET.md          # Desired target repository shape
│       └── GAPS.md            # Prioritized implementation gaps
├── Makefile                    # Build automation (sync-skills, check-skills)
├── README.md                   # Installation and usage guide
└── .gitignore                  # Version control exclusions
```

## Directory Purposes

**agy/skills/:**
- Purpose: Antigravity-compatible skill definitions for slash-command invocation
- Contains: 12 SKILL.md files defining research task personas
- Key files: Each skill has `SKILL.md` with inline XML-tagged protocol blocks
- Difference from Codex: Skills define boilerplate inline (no separate sync layer)

**codex/skills/:**
- Purpose: Codex-compatible skill definitions for agent reference
- Contains: 12 SKILL.md files + shared boilerplate central location
- Key files: Each skill has `SKILL.md`; `_shared/COMMON_BLOCKS.md` is canonical source
- Difference from Antigravity: Skills reference shared blocks; sync utility keeps them in-sync

**codex/skills/_shared/:**
- Purpose: Single source of truth for Codex skill protocol blocks
- Contains: `COMMON_BLOCKS.md` with 7 reusable XML-tagged blocks
- Key files: `COMMON_BLOCKS.md` (canonical boilerplate)
- Dependency: All 12 Codex skills must be synced after edits

**agy/workflows/ and codex/workflows/:**
- Purpose: Define sequential research pipeline stages
- Contains: `research-pipeline.md` stage definitions (Stage -1 through Stage 5)
- Key files: `research-pipeline.md` (stage guidance, expected outputs)
- Difference: Codex includes 0.5, 1.5, 2.5, 3.5, 4.5 substages; Antigravity simplifies

**scripts/:**
- Purpose: Installation and maintenance utilities
- Contains: Bash/PowerShell installers and Python boilerplate sync utility
- Key files: `install.sh`, `install.ps1`, `sync_skill_boilerplate.py`

**templates/:**
- Purpose: Standardized starting points for research documentation
- Contains: `research-notes.md` (continuous log), `wandb-config.md` (W&B tracking)
- Key files: Both are markdown templates with prescribed sections

**.planning/codebase/:**
- Purpose: GSD codebase mapping output directory
- Contains: Architecture analysis, structure, stack, conventions, testing patterns, concerns
- Key files: ARCHITECTURE.md, STRUCTURE.md (this doc), others generated by `/gsd:map-codebase`

## Key File Locations

**Entry Points:**

- `codex/skills/grd-codebase-mapper/SKILL.md`: Entry point for brownfield mapping (Stage -1)
- `codex/skills/grd-phase-researcher/SKILL.md`: Entry point for phase-level research (Stage 0.5)
- `codex/skills/grd-build-architect/SKILL.md`: Entry point for architecture design before coding
- `agy/skills/research-hypothesis-designer/SKILL.md`: Slash command for hypothesis framing

**Configuration:**

- `codex/skills/_shared/COMMON_BLOCKS.md`: Canonical boilerplate (Codex only)
- `codex/workflows/research-pipeline.md`: Codex pipeline reference (11 stages)
- `agy/workflows/research-pipeline.md`: Antigravity pipeline reference (9 stages)
- `Makefile`: Build targets (`sync-skills`, `check-skills`)

**Core Logic:**

- `scripts/sync_skill_boilerplate.py`: Python utility that parses COMMON_BLOCKS.md and updates all Codex skills in-place
- `scripts/install.sh`: Bash installer that creates `.agent/skills/` and `.codex/skills/` in target repo
- `scripts/install.ps1`: PowerShell installer for Windows environments

**Testing:**

- No test files in repository; validation via `make check-skills` (compares sync state)

## Naming Conventions

**Files:**

- Skills: `SKILL.md` (UPPERCASE; always singular filename)
- Workflows: `research-pipeline.md` (lowercase with hyphens)
- Boilerplate: `COMMON_BLOCKS.md` (UPPERCASE; shared location only)
- Artifacts: All-caps with underscores (e.g., `HYPOTHESIS.md`, `EXPERIMENT_PLAN.md`, `RESEARCH_NOTES.md`)
- Templates: lowercase with hyphens (e.g., `research-notes.md`)

**Directories:**

- Skills: lowercase with hyphens (e.g., `grd-codebase-mapper`, `research-hypothesis-designer`)
- Prefix by platform: `grd-*` for Codex, `research-*` for Antigravity
- Workflow parent: `workflows/` (lowercase)
- Skill parent: `skills/` (lowercase)
- Shared resources: `_shared/` (underscore prefix to sort first)

**XML Tags in SKILL.md:**

- Lowercase with underscores: `<context_budget>`, `<intent_lock>`, `<precision_contract>`
- Semantic names reflecting function: `<role>`, `<when_to_use>`, `<source_of_truth>`, `<delivery_rule>`
- Closing tag matches opening: `</tag>` with same name

## Where to Add New Code

**New Skill (Research Task):**
- Codex: Create `codex/skills/grd-{task-name}/SKILL.md` with full protocol blocks
- Antigravity: Create `agy/skills/research-{task-name}/SKILL.md` with inline boilerplate
- Template: Copy structure from existing skill; keep XML tag order consistent
- Run: `make check-skills` for Codex (validates structure)

**New Workflow Stage (Pipeline Extension):**
- Codex: Edit `codex/workflows/research-pipeline.md`; update both stage descriptions and output locations
- Antigravity: Edit `agy/workflows/research-pipeline.md`; maintain consistency with Codex where applicable
- Impact: Codex skills reference pipeline stages via `@GSD_ROOT@` paths; update affected `<source_of_truth>` blocks

**New Template (Research Artifact):**
- Location: `templates/` directory
- Naming: lowercase with hyphens (e.g., `new-output.md`)
- Reference: Update `README.md` to mention new template availability

**Shared Boilerplate Update (Codex only):**
1. Edit `codex/skills/_shared/COMMON_BLOCKS.md` (canonical source)
2. Run `make sync-skills` to apply to all 12 Codex skills
3. Verify with `make check-skills`
4. Commit resulting skill file updates

**Installation Script Update:**
- `scripts/install.sh`: Update bash logic (handles symlinks, file copies, permissions)
- `scripts/install.ps1`: Update PowerShell logic (handles Windows paths, ACLs if needed)
- Test both on target OS before committing

## Special Directories

**_.planning/**
- Purpose: Strategic outputs and planning artifacts
- Generated: By `/gsd:map-codebase` command and user research activities
- Committed: Yes (plans guide future work)
- User-created subdirectories: `.planning/codebase/` (mapping), `.planning/research/phases/` (phase research)

**_codex/skills/_shared/**
- Purpose: Canonical boilerplate for Codex skills
- Generated: Manually edited; never auto-generated
- Committed: Yes (source of truth)
- Special: Single file; protected by check-skills validation

**Build Artifacts / Outputs:**
- `.mypy_cache/`: Python type-check cache (not committed)
- `__pycache__/`, `__MACOSX/`: Python and macOS artifacts (not committed)
- User research outputs (`.grd/`, `.research_notes.md`, etc.): In user working directory, not this repo

---

*Structure analysis: 2026-02-10*
